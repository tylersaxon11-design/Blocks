<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HELL'S KITCHEN: Click Anywhere</title>
    <style>
        :root {
            --hk-red: #c41e3a;
            --hk-dark: #111;
            --hk-gold: #d4af37;
        }

        body {
            background-color: var(--hk-dark);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            user-select: none;
            cursor: crosshair; /* The whole screen is now the target */
            touch-action: manipulation; /* Improves touch response */
        }

        /* --- UI Elements --- */
        #game-container {
            text-align: center;
            width: 100%;
            max-width: 600px;
            position: relative;
            pointer-events: none; /* Let clicks pass through container to body */
        }

        h1 {
            font-size: 3rem;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 5px;
            color: white;
            text-shadow: 4px 4px 0px var(--hk-red);
            font-style: italic;
            margin-bottom: 10px;
            pointer-events: auto;
        }

        .hud {
            display: flex;
            justify-content: space-between;
            font-size: 1.5rem;
            padding: 0 20px;
            font-weight: bold;
            color: var(--hk-gold);
            text-shadow: 1px 1px 2px black;
            pointer-events: auto;
        }

        /* --- The Cutting Board --- */
        #cutting-board {
            background: #5c4033;
            background-image: repeating-linear-gradient(90deg, #5c4033 0, #5c4033 20px, #523a2e 20px, #523a2e 22px);
            border: 8px solid #3e2b22;
            border-radius: 15px;
            height: 350px;
            margin: 15px 20px;
            position: relative;
            box-shadow: 0 15px 30px rgba(0,0,0,0.7) inset, 0 10px 20px rgba(0,0,0,0.5);
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: auto; /* Catch clicks specifically here too */
        }

        /* The Main Food Item (Uncut) */
        #food-item {
            font-size: 9rem;
            z-index: 5;
            transition: transform 0.05s linear; /* Faster transition for snappiness */
            filter: drop-shadow(0 10px 10px rgba(0,0,0,0.5));
        }

        /* The Sliced Pieces */
        .food-slice {
            position: absolute;
            font-size: 5rem;
            pointer-events: none;
            z-index: 2;
            opacity: 1;
            transform-origin: center;
            filter: brightness(0.9);
        }

        /* The "Slash" visual effect - Now Global */
        .slash-effect {
            position: absolute;
            height: 6px;
            background: white;
            width: 200px;
            box-shadow: 0 0 10px white, 0 0 20px var(--hk-red);
            pointer-events: none;
            z-index: 9999;
            border-radius: 50%;
            animation: slashAnim 0.15s linear forwards;
        }

        @keyframes slashAnim {
            0% { transform: translate(-50%, -50%) scaleX(0) rotate(var(--angle)); opacity: 1; }
            50% { transform: translate(-50%, -50%) scaleX(1) rotate(var(--angle)); opacity: 1; }
            100% { transform: translate(-50%, -50%) scaleX(1) rotate(var(--angle)); opacity: 0; }
        }

        /* --- Progress Bars --- */
        .bar-container {
            width: 90%;
            margin: 0 auto;
            background: #222;
            height: 25px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #555;
            position: relative;
            pointer-events: auto;
        }

        #timer-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff8800, #c41e3a);
            width: 100%;
            transition: width 0.1s linear;
        }

        #chop-progress {
            margin-top: 5px;
            font-size: 1.2rem;
            color: #aaa;
            letter-spacing: 2px;
            height: 30px;
            pointer-events: auto;
        }

        /* --- Feedback Overlays --- */
        #feedback-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5rem;
            font-weight: 900;
            color: white;
            -webkit-text-stroke: 2px var(--hk-red);
            text-transform: uppercase;
            text-shadow: 4px 4px 0px black;
            opacity: 0;
            pointer-events: none;
            white-space: nowrap;
            z-index: 20;
        }

        /* --- Screens --- */
        #start-screen, #game-over-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 50;
            backdrop-filter: blur(5px);
            pointer-events: auto; /* Ensure buttons work */
        }

        button {
            background: transparent;
            color: white;
            border: 3px solid var(--hk-gold);
            padding: 15px 40px;
            font-size: 1.5rem;
            text-transform: uppercase;
            font-weight: bold;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.2s;
            box-shadow: 0 0 10px var(--hk-gold);
            pointer-events: auto;
        }

        button:hover {
            background: var(--hk-gold);
            color: black;
            box-shadow: 0 0 30px var(--hk-gold);
        }

        .hidden { display: none !important; }

    </style>
</head>
<body>

    <div id="game-container">
        <h1>Hell's Kitchen</h1>
        
        <div class="hud">
            <span>DISHES: <span id="score">0</span></span>
            <span><span id="timer-text">30</span>s</span>
        </div>

        <div class="bar-container">
            <div id="timer-bar"></div>
        </div>
        <div id="chop-progress">CLICK ANYWHERE!</div>

        <!-- The Board -->
        <div id="cutting-board">
            <div id="food-item"></div>
        </div>

        <div id="feedback-overlay"></div>
    </div>

    <!-- Start Screen -->
    <div id="start-screen">
        <h1 style="font-size: 2rem; text-shadow:none; color:var(--hk-gold)">YES CHEF!</h1>
        <p style="font-size: 1.2rem">TAP ANYWHERE TO CHOP</p>
        <p style="color:#888">Don't be a donkey.</p>
        <button id="start-btn">Start Service</button>
    </div>

    <!-- Game Over Screen -->
    <div id="game-over-screen" class="hidden">
        <h1 id="end-title" style="color:var(--hk-red); font-size: 4rem;">GET OUT!</h1>
        <p id="end-reason" style="font-size: 1.5rem;">The Risotto is burnt.</p>
        <p>Dishes Served: <span id="final-score" style="color:var(--hk-gold)">0</span></p>
        <button id="restart-btn">Restart Service</button>
    </div>

    <script>
        // Game Configuration
        const INITIAL_TIME = 30;
        
        // Game State
        let score = 0;
        let timeLeft = INITIAL_TIME;
        let gameInterval;
        let isPlaying = false;
        
        let currentItem = {};
        let cutsRemaining = 0;
        let maxCuts = 0;

        // Assets
        const foods = [
            { emoji: 'ðŸ…', name: 'Tomato', cuts: 5 },
            { emoji: 'ðŸ¥’', name: 'Cucumber', cuts: 6 },
            { emoji: 'ðŸ†', name: 'Aubergine', cuts: 6 },
            { emoji: 'ðŸ¥”', name: 'Potato', cuts: 8 },
            { emoji: 'ðŸ¥•', name: 'Carrot', cuts: 7 },
            { emoji: 'ðŸ¥©', name: 'Beef', cuts: 12 },
            { emoji: 'ðŸŸ', name: 'Salmon', cuts: 9 },
            { emoji: 'ðŸž', name: 'Bread', cuts: 5 },
            { emoji: 'ðŸ§€', name: 'Cheese', cuts: 4 }
        ];

        const insults = [
            "IT'S RAW!",
            "YOU DONKEY!",
            "GET OUT!",
            "WAKE UP!",
            "DISGUSTING!",
            "LOOK AT IT!",
            "WHERE IS THE LAMB SAUCE?!",
            "YOU COOK LIKE A OLD SHOE!",
            "MADNESS!"
        ];

        const praises = [
            "SERVICE!",
            "BEAUTIFUL.",
            "PERFECT.",
            "GO, GO!",
            "STUNNING."
        ];

        // Elements
        const elBoard = document.getElementById('cutting-board');
        const elFood = document.getElementById('food-item');
        const elScore = document.getElementById('score');
        const elTimerBar = document.getElementById('timer-bar');
        const elTimerText = document.getElementById('timer-text');
        const elChopText = document.getElementById('chop-progress');
        const elFeedback = document.getElementById('feedback-overlay');
        const elStartScreen = document.getElementById('start-screen');
        const elGameOverScreen = document.getElementById('game-over-screen');
        
        // Button Listeners
        document.getElementById('start-btn').addEventListener('click', (e) => {
            e.stopPropagation(); // Prevent this click from triggering a chop
            startGame();
        });
        document.getElementById('restart-btn').addEventListener('click', (e) => {
            e.stopPropagation(); // Prevent this click from triggering a chop
            startGame();
        });

        // --- GLOBAL INPUT HANDLER ---
        // Using 'pointerdown' triggers faster than 'click'
        document.addEventListener('pointerdown', (e) => {
            // Ignore if game isn't playing
            if (!isPlaying) return;

            // Ignore if clicking a button
            if (e.target.tagName === 'BUTTON') return;

            handleGlobalChop(e.clientX, e.clientY);
        });

        // --- Core Game Functions ---

        function startGame() {
            score = 0;
            timeLeft = INITIAL_TIME;
            isPlaying = true;
            
            // UI Reset
            elScore.innerText = score;
            elStartScreen.classList.add('hidden');
            elGameOverScreen.classList.add('hidden');
            elTimerBar.style.background = "linear-gradient(90deg, #ff8800, #c41e3a)";
            
            clearSlices();

            clearInterval(gameInterval);
            gameInterval = setInterval(gameLoop, 100);
            
            nextItem();
        }

        function gameLoop() {
            if (!isPlaying) return;

            timeLeft -= 0.1;
            elTimerText.innerText = Math.ceil(timeLeft);
            let percent = (timeLeft / INITIAL_TIME) * 100;
            elTimerBar.style.width = percent + "%";

            if(timeLeft < 10) elTimerBar.style.background = "#c41e3a";

            if (timeLeft <= 0) {
                gameOver("WE ARE SHUTTING IT DOWN!");
            }
        }

        function nextItem() {
            clearSlices();
            const foodData = foods[Math.floor(Math.random() * foods.length)];
            const difficulty = Math.floor(score / 4); 
            
            currentItem = { ...foodData };
            maxCuts = currentItem.cuts + difficulty;
            cutsRemaining = maxCuts;
            
            elFood.innerText = currentItem.emoji;
            elFood.style.transform = "scale(1)";
            elFood.style.opacity = "1";
            elFood.style.display = "block";
            
            updateChopText();
        }

        function updateChopText() {
            elChopText.innerText = `CLICK ANYWHERE: ${cutsRemaining} LEFT`;
        }

        // --- Interaction Logic ---

        function handleGlobalChop(x, y) {
            if (cutsRemaining <= 0) return;

            // 1. Logic
            cutsRemaining--;
            
            // 2. Visual: Slash where mouse is
            createSlash(x, y);
            
            // 3. Visual: Slice flying off (Always from center board)
            createSlicePiece();

            // 4. Visual: Shrink main food
            const percentLeft = cutsRemaining / maxCuts;
            elFood.style.transform = `scale(${percentLeft})`;
            
            if (cutsRemaining <= 0) {
                elFood.style.display = "none";
                dishComplete();
            } else {
                updateChopText();
            }
        }

        function createSlash(x, y) {
            const slash = document.createElement('div');
            slash.className = 'slash-effect';
            
            // Position exactly where user clicked
            slash.style.left = x + 'px';
            slash.style.top = y + 'px';
            
            // Random angle
            const angle = Math.floor(Math.random() * 180);
            slash.style.setProperty('--angle', angle + 'deg');

            document.body.appendChild(slash);

            setTimeout(() => slash.remove(), 200);
        }

        function createSlicePiece() {
            const slice = document.createElement('div');
            slice.className = 'food-slice';
            slice.innerText = currentItem.emoji;
            
            // Start at center of board
            slice.style.left = "50%";
            slice.style.top = "50%";
            
            // Random destination
            const moveX = (Math.random() - 0.5) * 500; 
            const moveY = (Math.random() - 0.5) * 400; 
            const rotation = Math.random() * 360;
            
            slice.style.transform = `translate(-50%, -50%) translate(0px, 0px)`;
            
            elBoard.appendChild(slice);

            // Force reflow
            void slice.offsetWidth;

            // Animate out
            slice.style.transition = "transform 0.4s ease-out";
            slice.style.transform = `translate(-50%, -50%) translate(${moveX}px, ${moveY}px) rotate(${rotation}deg) scale(0.8, 0.2)`;
        }

        function clearSlices() {
            const slices = document.querySelectorAll('.food-slice');
            slices.forEach(el => el.remove());
        }

        function dishComplete() {
            score++;
            elScore.innerText = score;
            timeLeft = Math.min(timeLeft + 3, 40); 
            
            showFeedback(true);
            setTimeout(nextItem, 150);
        }

        function showFeedback(isGood) {
            const text = isGood 
                ? praises[Math.floor(Math.random() * praises.length)]
                : insults[Math.floor(Math.random() * insults.length)];
            
            elFeedback.innerText = text;
            elFeedback.style.color = isGood ? "var(--hk-gold)" : "var(--hk-red)";
            elFeedback.style.opacity = "1";
            elFeedback.style.transform = "translate(-50%, -50%) scale(1.5)";
            elFeedback.style.transition = "all 0.1s ease-out";

            setTimeout(() => {
                elFeedback.style.opacity = "0";
                elFeedback.style.transform = "translate(-50%, -50%) scale(1)";
                elFeedback.style.transition = "all 0.5s ease-in";
            }, 500);
        }

        function gameOver(reason) {
            isPlaying = false;
            clearInterval(gameInterval);
            
            const randomInsult = insults[Math.floor(Math.random() * insults.length)];
            
            document.getElementById('end-title').innerText = randomInsult;
            document.getElementById('end-reason').innerText = `You served ${score} dishes before failing.`;
            document.getElementById('final-score').innerText = score;
            
            elGameOverScreen.classList.remove('hidden');
        }

    </script>
</body>
</html>
